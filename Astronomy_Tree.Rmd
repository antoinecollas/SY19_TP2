---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
plot(cars)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

```{r}
library(caret)
library(car)
library("e1071")
library(randomForest)
library(kernlab)
library(stats)
library(MASS)
library(lattice)
library(ggplot2)
library(carData)

astronomy_data <- read.table("data/astronomy_train.csv", sep =",", header = TRUE)
astronomy <- read.table("data/astronomy_train.csv", sep =",", header = TRUE)
summary(astronomy)
n=nrow(astronomy)
ntrain=ceiling(n*2/3)
ntest=n-ntrain
train<- sample(1:n,ntrain)
astronomy.test<-astronomy[-train,]
astronomy.train<-astronomy[train,]

#Random forest avec CV
n_fold <- 10
fold_i <- sample(rep(1:n_fold, length.out = n))
table(fold_i)
CV<-rep(0,10)
for (k in 1:n_fold) {
  test_i <- which(fold_i == k)
  train_xy <- astronomy.train[-test_i,]
  test_xy <- astronomy.train[test_i,]
  print(k)
  rf<-randomForest(class~., data=train_xy)
  pred_rf<-predict(rf, newdata = test_xy, type = "response")
  prop.table(table(test_xy$class,pred_rf))
  cm= as.matrix(table(test_xy$class,pred_rf))
  CV[k]<- sum(diag(cm)) / sum(cm)
  }
CVerreur= sum(CV)/length(CV)
CV
CVerreur



```


```{r}
#RDA
library(factoextra)
library(MASS)
library(klaR)
library(caret) # Folds
library(e1071) # naiveBayes
library(FNN)

T0 <- read.table("data/astronomy_train.csv", sep=",", header=TRUE)
colnames(T0)[1] <- "objid"
X0 <- scale(T0[,-c(12)])
y <- T0[, 12]
Z <- data.frame(X0, y)

evaluate <- function(c){
    ct <- table(y, c)
    diag(prop.table(ct, 1))
    sum(diag(prop.table(ct)))
}
M <- rda(y ~ ., data=Z, fold=nrow(Z), gamma=0, lambda=0)
1-evaluate(M$class)
```


```{r}
#LDA
n_folds <- 10
folds_i <- sample(rep)
```

